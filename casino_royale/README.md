# 3. Casino Royale

A remote server uses insecure RNGs for generating numbers for the lottery. Outsmart it by reverse engineering its inner state. The API consists of 2 methods:
Create account: GET /createacc?id={playerId}. Creates an account with a deposit of 1000 coins. Returns json in form:
{
        "id":"2",
        "money":1000,
        "deletionTime":"2017-10-26T23:30:54.4759175Z"
}
 
Make a bet and play: GET /play{Mode}?id={playerID}&bet={amountOfMoney}&number={theNumberYouBetOn}. Returns json like this:
{
        "message":"You lost this time",
        "account":{
               "id":"2",
               "money":999,
               "deletionTime":"2017-10-26T23:30:54.4759175Z"
        },
        "realNumber":34689329
}
 
Many real social casinos and games use similar insecure methods to generate results. Please be aware, this stuff is for you to practice and to remember how not to implement your own solutions, but NOT to use your knowledge to do harm. Doing this on real applications without proper permission can be viewed as breaking the law. You’ve been warned.
 
Single account may be used for different game modes. You create an account at
http://<host>/casino/createacc
and play at
http://<host>/casino/play{Mode} where {Mode} is either of these: Lcg, Mt, BetterMt.
 
Generators give int32 numbers. All bets are 1000:1. You win, if your account has more than 1 000 000 money. All generators are seeded just before the first usage. They are never reseeded.
 
Everyone “knows” how to do something. You will learn much more if you actually do it.
 
1.  Linear congruential generator. {Mode} in link is “Lcg”. Numbers are generated like this:
public int Next()
{
    _last = (a * _last + c) % m; // m is 2^32
    return (int) _last;
}
The first one who writes “a” and “c” values to group chat will get +1 scores.
Lesson to learn: just never use LCG for anything.
 
2.       Mersenne Twister 19937. {Mode} in link is “Mt”. Numbers are generated by the standard MT19937 algorithm. Seed is “DateTimeOffset.UtcNow.ToUnixTimeSeconds()”. From the 32 bit RNG output discover the seed. Use it to win.
Lesson to learn: a hard algorithm is not always a secure algorithm. Never seed your RNG with time or any other easily guessable numbers. It will make a strong algorithm weak.

3.       MT19937 with a strong seed. {Mode} in link is “BetterMt”. Seed is created with “System.Security.Cryptography.RandomNumberGenerator.Create()”.You need to extract the whole state of every register of MT to break this one. Create a new MT19937 generator, tap it for 624 outputs, untemper each of them to recreate the state of the generator, and splice that state into a new instance of the MT19937 generator. Use it to predict next values
Lesson to learn: Weak algorithm turns a strong seed into garbage. The security of a system is made up not by the sum of parts but by the min.

Upload all your results to a public github repo.
